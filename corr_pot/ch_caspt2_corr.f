      real*8 function ch_caspt2_corr(na,x)
c
c     na = number of atoms
c     x = cartesian coordinates 
c     e = energy correction in au
c
      implicit real*8 (a-h,o-z)
      dimension x(3,1)
      
      rch = dsqrt( (x(1,1)-x(1,na))**2 + (x(2,1)-x(2,na))**2 + 
     x             (x(3,1)-x(3,na))**2 )

      if(rch.le.2.0) rch = 2.0
      if(rch.ge.20.0) rch = 20.0

      call ch_caspt2(rch,ch_caspt2_corr)
      return 
      end

      subroutine ch_caspt2(xi,fi)
c
c     this subroutine returns the difference:
c
c            e(cas+1+2+qc/aug-cc-pvtz) - e(caspt2/cc-pvdz)
c
c     for Rch = xi on the ch3+h mep
c
c         umbrella angle        = 90.0 
c         deviation from planar =  0.0
c     
c
      IMPLICIT REAL*8 (A-H,O-Z)
      dimension x( 28), f( 28),fpp( 28),del( 27)
 
      data fpp(  1), fpp(  2) / -3.1597470590D-02 , -2.1587558820D-02 /
      data fpp(  3), fpp(  4) / -9.4472941314D-03 , -4.7632646548D-03 /
      data fpp(  5), fpp(  6) / -1.4996472495D-03 ,  7.2685365262D-04 /
      data fpp(  7), fpp(  8) /  2.3122326390D-03 ,  3.1642157914D-03 /
      data fpp(  9), fpp( 10) /  3.1809041952D-03 ,  2.5021674276D-03 /
      data fpp( 11), fpp( 12) /  1.3904260944D-03 ,  1.5612819496D-04 /
      data fpp( 13), fpp( 14) / -8.4493887419D-04 , -1.5163726982D-03 /
      data fpp( 15), fpp( 16) / -1.8345703331D-03 , -1.8703459696D-03 /
      data fpp( 17), fpp( 18) / -1.7690457885D-03 , -1.3589396497D-03 /
      data fpp( 19), fpp( 20) / -9.0269561286D-04 , -4.7454407397D-04 /
      data fpp( 21), fpp( 22) / -2.4232809126D-04 , -1.3054356101D-04 /
      data fpp( 23), fpp( 24) / -5.3897664718D-05 , -2.8352253422D-06 /
      data fpp( 25), fpp( 26) / -8.5614339129D-06 , -2.1480855901D-06 /
      data fpp( 27), fpp( 28) / -1.1654254244D-06 ,  2.5782127122D-06 /
 
      data f(  1), f(  2) / -9.6740000000D-03 , -8.0165000000D-03 /
      data f(  3), f(  4) / -7.2083000000D-03 , -6.8277000000D-03 /
      data f(  5), f(  6) / -6.6471000000D-03 , -6.5334000000D-03 /
      data f(  7), f(  8) / -6.3949000000D-03 , -6.1688000000D-03 /
      data f(  9), f( 10) / -5.8217000000D-03 , -5.3520000000D-03 /
      data f( 11), f( 12) / -4.7851000000D-03 , -4.1634000000D-03 /
      data f( 13), f( 14) / -3.5339000000D-03 , -2.9360000000D-03 /
      data f( 15), f( 16) / -2.3964000000D-03 , -1.9283000000D-03 /
      data f( 17), f( 18) / -1.5341000000D-03 , -9.4840000000D-04 /
      data f( 19), f( 20) / -5.7890000000D-04 , -3.1750000000D-04 /
      data f( 21), f( 22) / -1.8290000000D-04 , -1.1390000000D-04 /
      data f( 23), f( 24) / -7.9000000000D-05 , -4.7500000000D-05 /
      data f( 25), f( 26) / -2.8300000000D-05 , -9.4000000000D-06 /
      data f( 27), f( 28) / -2.1000000000D-06 , -1.0000000000D-07 /
 
      data x(  1), x(  2) /  2.0000000000D+00 ,  2.2000000000D+00 /
      data x(  3), x(  4) /  2.4000000000D+00 ,  2.6000000000D+00 /
      data x(  5), x(  6) /  2.8000000000D+00 ,  3.0000000000D+00 /
      data x(  7), x(  8) /  3.2000000000D+00 ,  3.4000000000D+00 /
      data x(  9), x( 10) /  3.6000000000D+00 ,  3.8000000000D+00 /
      data x( 11), x( 12) /  4.0000000000D+00 ,  4.2000000000D+00 /
      data x( 13), x( 14) /  4.4000000000D+00 ,  4.6000000000D+00 /
      data x( 15), x( 16) /  4.8000000000D+00 ,  5.0000000000D+00 /
      data x( 17), x( 18) /  5.2000000000D+00 ,  5.6000000000D+00 /
      data x( 19), x( 20) /  6.0000000000D+00 ,  6.5000000000D+00 /
      data x( 21), x( 22) /  7.0000000000D+00 ,  7.5000000000D+00 /
      data x( 23), x( 24) /  8.0000000000D+00 ,  9.0000000000D+00 /
      data x( 25), x( 26) /  1.0000000000D+01 ,  1.2000000000D+01 /
      data x( 27), x( 28) /  1.5000000000D+01 ,  2.0000000000D+01 /
 
      data del(  1), del(  2) /  2.0000000000D-01 ,  2.0000000000D-01 /
      data del(  3), del(  4) /  2.0000000000D-01 ,  2.0000000000D-01 /
      data del(  5), del(  6) /  2.0000000000D-01 ,  2.0000000000D-01 /
      data del(  7), del(  8) /  2.0000000000D-01 ,  2.0000000000D-01 /
      data del(  9), del( 10) /  2.0000000000D-01 ,  2.0000000000D-01 /
      data del( 11), del( 12) /  2.0000000000D-01 ,  2.0000000000D-01 /
      data del( 13), del( 14) /  2.0000000000D-01 ,  2.0000000000D-01 /
      data del( 15), del( 16) /  2.0000000000D-01 ,  2.0000000000D-01 /
      data del( 17), del( 18) /  4.0000000000D-01 ,  4.0000000000D-01 /
      data del( 19), del( 20) /  5.0000000000D-01 ,  5.0000000000D-01 /
      data del( 21), del( 22) /  5.0000000000D-01 ,  5.0000000000D-01 /
      data del( 23), del( 24) /  1.0000000000D+00 ,  1.0000000000D+00 /
      data del( 25), del( 26) /  2.0000000000D+00 ,  3.0000000000D+00 /
      data del( 27) /  5.0000000000D+00 /
      data npts / 28/
 

      IF(XI .LE. X(1)) THEN
        ii=1
      ELSE IF( XI .GE. X(npts)) THEN
        ii=npts-1
      ELSE
        call hunt(x,npts,xi,ii)
      ENDIF
      
 20      FI = FPP(II)   * (X(II+1)-XI)**3 / (6.0*DEL(II)) + 
     X     FPP(II+1) * (XI-X(II))**3   / (6.0*DEL(II)) +
     X     ((F(II+1)/DEL(II))-(FPP(II+1)*DEL(II)/6.0)) * (XI-X(II)) + 
     X     ((F(II)  /DEL(II))-(FPP(II)  *DEL(II)/6.0)) * (X(II+1)-XI)
      FI = FI + 0.00 
      RETURN
      END  
